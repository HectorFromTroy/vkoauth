(window.webpackJsonpwebimtesttask=window.webpackJsonpwebimtesttask||[]).push([[0],{38:function(e,t,n){e.exports=n(67)},43:function(e,t,n){},67:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(31),s=n.n(o);n(43),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=n(12),c=n.n(i),l=n(17),f=n(32),u=n(7),m=n(8),p=n(10),h=n(9),d=n(11),E=n(6),v=n(37),b=function(e){var t=window.location.href;return r.a.createElement("div",{className:"welcome"},r.a.createElement("h1",null,"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c"),r.a.createElement("a",{className:"authorizationButton",href:"https://oauth.vk.com/authorize?client_id=".concat(e.APP_ID,"&display=page&redirect_uri=").concat(t,"&scope=friends&response_type=token&v=").concat(e.API_VERSION)},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f"))},I=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).startParsingAndSettingToCookies=function(e){try{var t=n.parseParams(e.match.params.info),a=t.accessToken,r=t.expiresIn,o=t.userID,s=t.accessTokenStart;e.cookies.set("accessToken",a),e.cookies.set("expiresIn",r),e.cookies.set("userID",o),e.cookies.set("accessTokenStart",s),e.processReceivedAccessData(t)}catch(i){e.onAuthError()}},n.parseParams=function(e){var t=e.split("&");return{accessToken:t[0].substring(13),expiresIn:1e3*t[1].substring(11),userID:t[2].substring(8),accessTokenStart:(new Date).getTime()}},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.startParsingAndSettingToCookies(this.props)}},{key:"render",value:function(){return null}}]),t}(a.Component),_=n(15),k=function(e){return r.a.createElement("main",{className:"error"},r.a.createElement("h1",null,"\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438"),r.a.createElement("p",null,e.message)," ",r.a.createElement(_.b,{to:"/"}," \u041d\u0430\u0436\u043c\u0438\u0442\u0435 \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0445\u043e\u0434\u0430 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438."))},A=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){this.props.getProfileInfo()}},{key:"render",value:function(){return r.a.createElement("div",{className:"profile"},r.a.createElement("main",{className:"profile-main"},r.a.createElement("section",{className:"profile-info-container"},r.a.createElement("h2",null,"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"),r.a.createElement("div",{className:"profile-info"},r.a.createElement("img",{src:this.props.profileInfo.photo_100,alt:"profile avatar",className:"avatar"}),r.a.createElement("span",{className:"profile-info__first-name first-name"},this.props.profileInfo.first_name),r.a.createElement("span",{className:"profile-info__last-name"},this.props.profileInfo.last_name))),r.a.createElement("section",{className:"friends-info-container"},r.a.createElement("h2",null,"\u0414\u0440\u0443\u0437\u044c\u044f"),r.a.createElement("div",{className:"friends-info"},r.a.createElement("ul",{className:"friends-list"},this.props.friendsInfo.map(function(e,t){return r.a.createElement("li",{key:t,className:"friends-list__item"},r.a.createElement("img",{src:e.photo_100,alt:"friends avatar",className:"avatar"}),r.a.createElement("span",{className:"friends-info__first-name first-name"},e.first_name),r.a.createElement("span",{className:"friends-info__last-name"},e.last_name))}))))))}}]),t}(a.Component),O=n(35),g=n.n(O),w=n(36),j=n.n(w),P=g.a.create({baseURL:"https://api.vk.com/method",adapter:j.a}),y=function(){var e=Object(l.a)(c.a.mark(function e(t,n){var a,r,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.userID,r=t.accessToken,o='\n    var profileInfo = API.users.get({\n      "user_id": "'.concat(a,'",\n      "fields": "photo_100"\n    });\n    var friendsInfo = API.friends.search({\n      "user_id": "').concat(a,'",\n      "fields": "photo_100",\n      "count": "5"\n    });\n    return {\n      "profileInfo": profileInfo,\n      "friendsInfo": friendsInfo\n    };\n  '),e.next=4,P("execute?code=".concat(o,"&access_token=").concat(r,"&v=").concat(n));case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}();function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(n,!0).forEach(function(t){Object(f.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var T=new v.a,z="5.101",S=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(h.a)(t).call(this,e))).checkAuthorization=function(e){var t=e.userID,a=e.accessToken,r=e.accessTokenStart,o=e.expiresIn;return n.isAllAuthDataOK(t,a,r,o)&&n.isAccessTokenValid(r,o)?{isAuthorized:!0,userID:t,accessToken:a,accessTokenStart:r,expiresIn:o}:{isAuthorized:!1}},n.isAllAuthDataOK=function(e,t,n,a){return e&&t&&n&&a},n.isAccessTokenValid=function(e,t){return(new Date).getTime()<e+t},n.processReceivedAccessData=function(e){n.setState({didAccessDataAvailable:!0,authorizationInfo:N({isAuthorized:!0},e)})},n.getProfileInfo=Object(l.a)(c.a.mark(function e(){var t,a,r,o,s,i,l,f;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return f=function(){for(var e=[],t=a.response.friendsInfo.items,n=0;n<t.length;n++){var r=t[n],o=r.first_name,s=r.last_name,i=r.photo_100;e.push({first_name:o,last_name:s,photo_100:i})}return e},e.next=3,y(n.state.authorizationInfo,z);case 3:t=e.sent,a=t.data,r=a.response.profileInfo[0],o=r.first_name,s=r.last_name,i=r.photo_100,l=f(),n.setState({mainProfileInfo:{first_name:o,last_name:s,photo_100:i},friendsInfo:l});case 9:case"end":return e.stop()}},e)})),n.onAuthError=function(){n.setState({authError:{isAuthError:!0}})},n.state={didAccessDataAvailable:!1,authError:{isAuthError:!1,message:""},authorizationInfo:n.checkAuthorization(T.getAll()),mainProfileInfo:{first_name:"",last_name:"",photo_100:""},friendsInfo:[]},n}return Object(d.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("main",{className:"app"},r.a.createElement(E.d,null,r.a.createElement(E.b,{exact:!0,path:"/",render:function(t){return e.state.authorizationInfo.isAuthorized?r.a.createElement(E.a,{to:"/profile"}):r.a.createElement(b,{APP_ID:"7094008",API_VERSION:z})}}),r.a.createElement(E.b,{path:"/profile",render:function(t){return e.state.authorizationInfo.isAuthorized?r.a.createElement(A,Object.assign({},t,{profileInfo:e.state.mainProfileInfo,friendsInfo:e.state.friendsInfo,getProfileInfo:e.getProfileInfo})):r.a.createElement(k,{message:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u044b \u043b\u0438\u0431\u043e \u0441\u0440\u043e\u043a \u0438\u0445 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0438\u0441\u0442\u0435\u043a."})}}),r.a.createElement(E.b,{path:"/authenticationError",render:function(){return r.a.createElement(k,{message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438."})}}),r.a.createElement(E.b,{path:"/:info",render:function(t){return e.state.didAccessDataAvailable?r.a.createElement(E.a,{to:"/profile"}):e.state.authError.isAuthError?r.a.createElement(E.a,{to:"/authenticationError"}):r.a.createElement(I,Object.assign({},t,{cookies:T,processReceivedAccessData:e.processReceivedAccessData,onAuthError:e.onAuthError}))}})))}}]),t}(a.Component);s.a.render(r.a.createElement(_.a,null,r.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[38,1,2]]]);
//# sourceMappingURL=main.a0a32118.chunk.js.map